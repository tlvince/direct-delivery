"use strict";angular.module("log",["toastr"]),angular.module("log").constant("WARNING_MESSAGES",{}),angular.module("log").constant("SUCCESS_MESSAGES",{}),angular.module("log").constant("INFO_MESSAGES",{}),angular.module("log").constant("ERROR_MESSAGES",{stateChangeError:{title:"Application error",message:"Could not load page",remedy:"Please try that again"}}),angular.module("packing.item",[]),angular.module("packing.item").config(["$stateProvider",function(e){e.state("packing.item",{url:"/:id",templateUrl:"app/packing/item/item.html",controller:"PackingItemCtrl",controllerAs:"packingItemCtrl",resolve:{packingLists:["$stateParams","packingItemService",function(e,n){return n.get(e.id)}]}})}]),angular.module("packing.item").service("packingItemService",["couchdb","couchUtil",function(e,n){function a(e){function n(e){return 3===e.key.length}function a(e){var n=e.key[2];t[n]=e.value}var t={};return e.rows.filter(n).forEach(a),t}this.get=function(t){var r={ddoc:"daily-deliveries",view:"delivery-packing-list",group:!0},i=n.join(t);return angular.extend(r,i),e.view(r).$promise.then(a)}}]),angular.module("packing.item").controller("PackingItemCtrl",["$stateParams","packingLists",function(e,n){this.name=e.id,this.packingLists=n}]),angular.module("packing.all",[]),angular.module("packing.all").config(["$stateProvider",function(e){e.state("packing.all",{url:"/all",templateUrl:"app/packing/all/all.html",controller:"PackingAllCtrl",controllerAs:"packingAllCtrl",resolve:{packings:["packingAllService",function(e){return e.all()}]}})}]),angular.module("packing.all").service("packingAllService",["user","couchdb","couchUtil",function(e,n,a){this.all=function(){var t={ddoc:"daily-deliveries",view:"by-driver",reduce:!1},r=a.key(e.email);return angular.extend(t,r),n.view(t).$promise.then(a.pluckIDs)}}]),angular.module("packing.all").controller("PackingAllCtrl",["packings",function(e){this.packings=e}]),angular.module("user",[]),angular.module("user").constant("user",{email:"abdullahi.ahmed@example.com"}),angular.module("navbar",[]),angular.module("navbar").service("navbarService",["$state",function(e){this.get=function(){function n(e){return!e.abstract&&e.data&&e.data.label}function a(e){return-1===e.name.indexOf(".")}function t(e){return{name:e.name,label:e.data.label}}var r=e.get();return r.filter(n).filter(a).map(t)}}]),angular.module("navbar").controller("NavbarCtrl",["config","navbarService",function(e,n){this.name=e.name,this.items=n.get()}]),angular.module("log").service("log",["$log","toastr","ERROR_MESSAGES","WARNING_MESSAGES","INFO_MESSAGES","SUCCESS_MESSAGES",function(e,n,a,t,r,i){function l(a,t,r,i,l){i=i||{},angular.isObject(t)||(t={log:t,toastr:t});var o=r[a]||{message:""},c=[o.message];return l&&c.push(l),("error"===t.log||"warn"===t.log)&&c.push(o.remedy),c=c.join(". ")+".",e[t.log](c,o,i),n[t.toastr](c,o.title)}this.error=function(e,n,t){return l(e,"error",a,n,t)},this.warning=function(e,n,a){var r={log:"warn",toastr:"warning"};return l(e,r,t,n,a)},this.info=function(e,n,a){return l(e,"info",r,n,a)},this.success=function(e,n,a){var t={log:"log",toastr:"success"};return l(e,t,i,n,a)}}]),angular.module("footer",[]),angular.module("footer").controller("FooterCtrl",["config",function(e){this.year=(new Date).getFullYear(),this.author=e.author,this.version=e.version}]),angular.module("couchdb",["ngResource"]),angular.module("couchdb").service("couchUtil",function(){function e(e,n){function a(e){return e[n]}return e.rows.map(a)}this.key=function(e){return{startkey:JSON.stringify(e),endkey:JSON.stringify(e+"￰")}},this.join=function(e){return{startkey:JSON.stringify([e]),endkey:JSON.stringify([e,2])}},this.pluckIDs=function(n){return e(n,"id")},this.pluckValues=function(n){return e(n,"value")},this.pluckDocs=function(n){return e(n,"doc")}}),angular.module("couchdb").factory("couchdb",["$resource","config",function(e,n){return e(n.db,{},{view:{method:"GET",url:n.db+"/_design/:ddoc/_view/:view"}})}]),angular.module("packing",["user","couchdb","packing.all","packing.item"]),angular.module("packing").config(["$stateProvider",function(e){e.state("packing",{url:"/packing",parent:"index",templateUrl:"app/packing/packing.html",controller:"PackingCtrl",controllerAs:"packingCtrl",resolve:{count:["packingService",function(e){return e.count()}]},data:{label:"Packing"}})}]),angular.module("packing").service("packingService",["user","couchdb","couchUtil",function(e,n,a){this.count=function(){var t={ddoc:"daily-deliveries",view:"by-driver"},r=a.key(e.email);return angular.extend(t,r),n.view(t).$promise.then(a.pluckValues)}}]),angular.module("packing").controller("PackingCtrl",["count",function(e){this.count=e[0]||0}]),angular.module("home",[]),angular.module("home").config(["$stateProvider",function(e){e.state("home",{url:"/",parent:"index",templateUrl:"app/home/home.html",data:{label:"Home"}})}]),angular.module("directDelivery",["ui.router","ui.bootstrap","config","navbar","footer","home","log","packing"]),angular.module("directDelivery").config(["$stateProvider","$urlRouterProvider",function(e,n){n.otherwise("/"),e.state("root",{"abstract":!0,views:{root:{templateUrl:"app/index.html",controller:"IndexCtrl"}}}).state("index",{parent:"root","abstract":!0,views:{header:{templateUrl:"components/navbar/navbar.html",controller:"NavbarCtrl",controllerAs:"navbarCtrl"},content:{},footer:{templateUrl:"components/footer/footer.html",controller:"FooterCtrl",controllerAs:"footerCtrl"}}})}]),angular.module("directDelivery").controller("IndexCtrl",["$rootScope","log",function(e,n){function a(e){n.error("stateChangeError",e)}e.$on("$stateChangeError",a)}]),angular.module("config",[]).constant("config",{name:"direct-delivery",version:"1.0.1",author:"eHealth Africa",db:"https://dev-db.ehealth.org.ng/deliveries"}),angular.module("directDelivery").run(["$templateCache",function(e){e.put("app/index.html",'<div ui-view="header"></div><section class="container content"><div ui-view="content"><div ui-view=""></div></div></section><div ui-view="footer"></div>'),e.put("app/home/home.html","<h1>Welcome to Direct Delivery</h1>"),e.put("components/navbar/navbar.html",'<nav class="navbar navbar-static-top navbar-inverse"><div class="container-fluid"><div class="navbar-header"><a class="navbar-brand" href="#/"><span class="glyphicon glyphicon-home"></span> <span ng-bind="::navbarCtrl.name"></span></a></div><div class="collapse navbar-collapse" id="bs-example-navbar-collapse-6"><ul class="nav navbar-nav"><li ng-repeat="item in navbarCtrl.items track by item.name" ui-sref-active="active"><a ui-sref="{{item.name}}" ng-bind="::item.label"></a></li></ul></div></div></nav>'),e.put("app/packing/packing.html",'<h1>Packing List</h1><span>You have</span> <span ng-bind="packingCtrl.count"></span> <a ui-sref="packing.all">active packing lists</a><div ui-view=""></div>'),e.put("components/footer/footer.html",'<footer id="footer"><div class="container"><small class="text-muted"><span>©</span> <span ng-bind="::footerCtrl.year"></span> <span ng-bind="::footerCtrl.author"></span> <span class="pull-right"><span>v</span><span ng-bind="::footerCtrl.version"></span></span><nav role="navigation"><ul class="list-inline"><li><a ui-sref="contact">Contact Us</a></li></ul></nav></small></div></footer>'),e.put("app/packing/all/all.html",'<ul><li ng-repeat="packingID in packingAllCtrl.packings"><a ui-sref="packing.item({id: packingID})" ng-bind="packingID"></a></li></ul>'),e.put("app/packing/item/item.html",'<h2 ng-bind="packingItemCtrl.name"></h2><table class="table table-striped"><tr><th>Product</th><th>Expected Quantity</th></tr><tr ng-repeat="(id, qty) in packingItemCtrl.packingLists track by id"><td ng-bind="id"></td><td ng-bind="qty"></td></tr></table>')}]);